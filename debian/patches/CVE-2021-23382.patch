Description: Fix ReDoS in previous-map
Author: Yeting Li <liyt@ios.ac.cn>
Origin: upstream, https://github.com/postcss/postcss/commit/2ad1ca9b
Bug: https://snyk.io/vuln/SNYK-JS-POSTCSS-1255640
Forwarded: not-needed
Reviewed-By: Yadd <yadd@debian.org>
Last-Update: 2021-04-29

--- a/lib/previous-map.js
+++ b/lib/previous-map.js
@@ -49,12 +49,12 @@
 
   getAnnotationURL (sourceMapString) {
     return sourceMapString
-      .match(/\/\*\s*# sourceMappingURL=(.*)\*\//)[1]
+      .match(/\/\*\s*# sourceMappingURL=((?:(?!sourceMappingURL=).)*)\*\//)[1]
       .trim()
   }
 
   loadAnnotation (css) {
-    let annotations = css.match(/\/\*\s*# sourceMappingURL=.*\*\//gm)
+    let annotations = css.match(/\/\*\s*# sourceMappingURL=(?:(?!sourceMappingURL=).)*\*\//gm)
 
     if (annotations && annotations.length > 0) {
       // Locate the last sourceMappingURL to avoid picking up
